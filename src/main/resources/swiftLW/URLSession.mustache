//
// URLSession+{{projectName}}.swift
//
// Generated by swagger-codegen
// https://github.com/swagger-api/swagger-codegen
//

extension URLSession {

    func jsonTaskCompletionHandler<T: Decodable>(_ completionHandler: @escaping (T?, URLResponse?, Error?) -> Void) -> (Data?, URLResponse?, Error?) -> Void {
        return { data, response, error in

            if let error = error {
                completionHandler(nil, response, error)
                return
            }

            guard let data = data else {
                completionHandler(nil, response, {{projectName}}Error(code: -1, message: "Keine Daten erhalten."))
                return
            }

            do {
                completionHandler(try JSONDecoder().decode(T.self, from: data), response, nil)
            } catch {
                completionHandler(nil, response, error)
            }
        }
    }

    func jsonTask<T: Decodable>(with request: URLRequest, completionHandler: @escaping (T?, URLResponse?, Error?) -> Void) -> URLSessionDataTask {
        return dataTask(with: request, completionHandler: jsonTaskCompletionHandler(completionHandler))
    }

}
